//@copyright Lenovo service wechat jssdk, version: 0.2.0
var nov=function(e){"use strict";var n=window.navigator.userAgent.toLowerCase();function t(){return n.includes("micromessenger")}var o,r,i=(o=location.search,r={},(o.split("?")[1]?o.split("?")[1].split("&"):[]).forEach(function(e){var n=e.split("=");r[n[0]]=decodeURIComponent(n[1])}),function(e){return r[e]});function a(e){var n=void 0,t=void 0,o=void 0,r=void 0,i=e?void 0:"",a=(document.cookie||"").split("; ");for(n=0;n<a.length;n++)if(o=(t=a[n].split("=")).shift(),r=t.join("="),e&&e===o){i=r;break}return i}var s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},c="//gw.lenovo.com.cn/service/gateway/wechatJsConf";var d=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],u=function(e){var n,t=void 0,o=void 0,r=void 0,i=void 0,a=void 0,s=void 0;for(n=e.length,a=0,s="";a<n;){do{t=d[255&e.charCodeAt(a++)]}while(a<n&&-1==t);if(-1==t)break;do{o=d[255&e.charCodeAt(a++)]}while(a<n&&-1==o);if(-1==o)break;s+=String.fromCharCode(t<<2|(48&o)>>4);do{if(61==(r=255&e.charCodeAt(a++)))return s;r=d[r]}while(a<n&&-1==r);if(-1==r)break;s+=String.fromCharCode((15&o)<<4|(60&r)>>2);do{if(61==(i=255&e.charCodeAt(a++)))return s;i=d[i]}while(a<n&&-1==i);if(-1==i)break;s+=String.fromCharCode((3&r)<<6|i)}return s},h=function(e){for(var n="",t=0,o=e.length,r=void 0,i=void 0,a=void 0;t<o;)switch((r=e.charCodeAt(t++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=e.charAt(t-1);break;case 12:case 13:i=e.charCodeAt(t++),n+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=e.charCodeAt(t++),a=e.charCodeAt(t++),n+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&a)<<0)}return n};var l={jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],defaultImage:"http://driverdl.lenovo.com.cn/FE/static/image/lenovo-share.jpg"},p="LOADED",f="[nov-wechat]",v=null,w=!1,m=new Promise(function(e,t){void/iphone os/.test(n)?window.addEventListener("load",function(){e(p)}):e("OK")});function g(e){var n,t,o,r=e.jsApiList,i=e.debugFlag;return v||(v=(n="//res.wx.qq.com/open/js/jweixin-1.2.0.js",t=document.getElementsByTagName("head")[0],o=document.createElement("script"),o.type="text/javascript",o.src=n,o.async=!0,t.appendChild(o),new Promise(function(e,n){o.onload=function(){e()}})).then(function(){return p})),r.forEach(function(e){l.jsApiList.includes(e)||l.jsApiList.push(e)}),Promise.all([v,new Promise(function(e,n){var t=new XMLHttpRequest;t.addEventListener("readystatechange",function(){4===this.readyState&&e(JSON.parse(this.responseText))}),t.addEventListener("error",function(e){n(e)}),t.open("POST",c),t.setRequestHeader("Accept","*/*"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("url="+encodeURIComponent(window.location.href.split("#")[0]))})]).then(function(e){var n=e[1];return wx.config({debug:i,appId:n.data.appId,timestamp:n.data.timestamp,nonceStr:n.data.noncestr,signature:n.data.signature,jsApiList:l.jsApiList}),new Promise(function(e,n){wx.ready(function(){e(wx)}),wx.error(function(e){n(e)})})}).catch(function(e){return Promise.reject(e)})}var A=function(e){var n=e.jsApiList,o=void 0===n?l.jsApiList:n,r=e.debugFlag,i=void 0!==r&&r;return t()?g({jsApiList:o,debugFlag:i}):Promise.reject("not wechat")};function C(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=window.location.origin+window.location.pathname;/.lenovo.com.cn/.test(n)?t()||console.warn(f,"需要在微信下打开窗口"):console.error(f,"网关不支持除 lenovo.com.cn 以外的域名授权。");var o=["http://weixin.lenovo.com.cn/service/gateway/"],r=a("wxuser"),s=null;r?s=h(u(r)):e||o.push("NonsilentAuth?url="+n);var c=a("openid")||i("openid");if(!c&&s)try{c=JSON.parse(s).openid}catch(e){console.error(f,"JSON parse error",e)}return c&&e?c:(e&&o.push("AutoAuthorize?url="+n),o.length>1?(w&&(window.location.search?o.push(window.location.search+"&dmp=1"):o.push("?dmp=1")),m.then(function(){sessionStorage.setItem("nov-url-hash",window.location.hash),window.location.href=o.join("")}),null):e?c:s)}var j=t();return e.initWechatShare=function(e){return A({jsApiList:l.jsApiList}).then(function(n){var t=s({desc:e.description,link:e.link||location.href,imgUrl:e.image||l.defaultImage},e);return n.onMenuShareTimeline(t),n.onMenuShareAppMessage(t),"ok"})},e.initWechatJSSDK=A,e.getOpenid=function(){return C(!0)},e.getUserInfo=function(){return C(!1)},e.isWeixin=j,e.setDmp=function(e){w=e},e}({});
//# sourceMappingURL=nov.min.js.map
